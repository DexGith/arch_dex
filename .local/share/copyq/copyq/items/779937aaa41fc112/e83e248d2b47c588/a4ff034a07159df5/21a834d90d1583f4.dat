#!/bin/sh

# ===================================================================
# Part 1: Recreate the Static Graphical Session Context
# These are essential for any GUI application to feel native.
# ===================================================================
export DISPLAY=:0
export LANG='en_US.UTF-8'
export XAUTHORITY='/home/dex/.Xauthority'
export DBUS_SESSION_BUS_ADDRESS='unix:path=/run/user/1000/bus'
export QT_QPA_PLATFORMTHEME='qt6ct'
export XDG_CURRENT_DESKTOP='LXQt'
export XDG_SESSION_DESKTOP='lxqt'
export XDG_SESSION_TYPE='x11'
export XDG_SEAT='seat0'
export XDG_SESSION_CLASS='user'
export XDG_SESSION_ID='2' # Note: This might change, but is usually fine.
export XDG_CONFIG_DIRS='/etc:/etc/xdg:/usr/share'
export XDG_DATA_DIRS='/home/dex/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share'
export XDG_RUNTIME_DIR='/run/user/1000' # CRITICAL FIX: Define this variable.

# ===================================================================
# Part 2: Define the User's Personal Environment
# ===================================================================

# Set standard tools
export EDITOR=nvim
export MANPAGER='nvim +Man!'

# Set up sockets and colors
export SSH_AUTH_SOCK="$XDG_RUNTIME_DIR/ssh-agent.socket"
export LS_COLORS="$LS_COLORS:ow=30;44:"

# --- Pyenv Initialization (CORRECT ORDER) ---
# 1. Define the root directory FIRST.
export PYENV_ROOT="$HOME/.pyenv"

# 2. Add pyenv to the PATH.
export PATH="$PYENV_ROOT/bin:$PATH"

# 3. Let pyenv set up its shims.
eval "$(pyenv init --path)"
eval "$(pyenv init -)"

# --- Add other custom directories to PATH ---
# It's still recommended to fix the source of the duplicate/broken paths
# in your main .zshrc file.
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"
export PATH="$HOME/scripts/ddesk:$HOME/scripts/ddesk/nothing:$HOME/scripts/ddesk/obsidian:$PATH"